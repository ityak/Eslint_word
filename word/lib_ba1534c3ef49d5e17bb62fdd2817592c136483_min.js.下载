(function(b,a){if(a){b=window.location.protocol+"//js.tapd.cn/"}TFL.add("topnav",{path:b+"js/topnav.js"});TFL.add("header",{path:b+"js/header.js"});TFL.add("leftTree",{path:b+"js/left_tree.js"});TFL.add("DialogCreateWorkspace",{path:b+"js/dialog_create_workspace.js"});TFL.add("search",{path:b+"js/search.js"});TFL.add("SetFavorite",{path:b+"js/set_favorite.js"});TFL.add("TestPlanAdd",{path:b+"js/sparrow/test_plan_add.js",requires:["URLParser"]});TFL.add("TestPlanAddV2",{path:b+"js/sparrow/test_plan_add_v2.js",requires:["URLParser"]});TFL.add("TestPlanEditV2",{path:b+"js/sparrow/test_plan_add_v2.js",requires:["URLParser"]});TFL.add("TestPlanEdit",{path:b+"js/sparrow/test_plan_add.js",requires:["URLParser"]});TFL.add("TcaseAdd",{path:b+"js/sparrow/tcase_add.js",requires:["FormChangeTips"]});TFL.add("TcaseAddV2",{path:b+"js/sparrow/tcase_add_v2.js",requires:["FormChangeTips"]});TFL.add("TcaseEditV2",{path:b+"js/sparrow/tcase_add_v2.js",requires:["FormChangeTips"]});TFL.add("TcaseQuickManage",{path:b+"js/sparrow/tcase_quick_manage.js",requires:["TcaseAdd","CategoryParentDialog"]});TFL.add("TcaseEdit",{path:b+"js/sparrow/tcase_add.js",requires:["FormChangeTips"]});TFL.add("TcaseList",{path:b+"js/sparrow/tcase_list.js"});TFL.add("Validater",{path:b+"js/tfl_validate.js"});TFL.add("CategoryParentDialog",{path:b+"js/category.js",requires:["ZTree","ZTreeExedit"]});TFL.add("KDialog",{path:b+"js/tfl_kdialog.js",requires:["TapdFilter"]});TFL.add("KDialog.frame",{path:b+"js/tfl_kdialog.js",requires:["TapdFilter"]});TFL.add("KDialog.SelectedList",{path:b+"js/tfl_kdialog.js",requires:["TapdFilter"]});TFL.add("WorktableCounting",{path:b+"js/worktable_counting.js"});TFL.add("TreeTable",{path:b+"js/sparrow/tree_table.js"});TFL.add("TcaseExecute",{path:b+"js/sparrow/tcase_execute.js",requires:["CustomDialog"]});TFL.add("CustomDialog",{path:b+"js/sparrow/custom_dialog.js"});TFL.add("PlanExecute",{path:b+"js/sparrow/plan_execute.js"});TFL.add("TcaseResult",{path:b+"js/sparrow/tcase_result.js",requires:["CustomDialog"]});TFL.add("TapdFilter",{path:b+"js/tapd_filter.js",requires:["URLParser"]});TFL.add("URLParser",{path:b+"js/jquery.url.js"});TFL.add("Util",{path:b+"js/lib.js"});TFL.add("JqueryTreeViewJs",{path:b+"js/jquery.treeview.min.js"});TFL.add("tcasePreview",{path:b+"js/sparrow/tcase_preview.js"});TFL.add("WorkspaceReport.Workitems",{path:b+"js/report/report_workitems.js"});TFL.add("WorkspaceReport.ChooseWorkitems",{path:b+"js/report/choose_workitem.js",requires:["WorkspaceReport.Workitems"]});TFL.add("TestPlanDetail",{path:b+"js/sparrow/test_plan_detail.js",requires:["CustomDialog","URLParser"]});TFL.add("TestPlanDetailV2",{path:b+"js/sparrow/test_plan_detail_v2.js",requires:["CustomDialog","URLParser"]});TFL.add("TcaseBug",{path:b+"js/sparrow/tcase_bug.js"});TFL.add("guide",{path:b+"js/guide.js"});TFL.add("CommonTemplage",{path:b+"js/common_templage.js"});TFL.add("FormChangeTips",{path:b+"js/form_change_tips.js"});TFL.add("StatusTransferValidate",{path:b+"js/status_transfer_validate.js"});TFL.add("StatusTransferValidateBug",{path:b+"js/status_transfer_validate_bug.js"});TFL.add("TapdValidate",{path:b+"js/tfl_tapd_validate.js"});TFL.add("ZTree",{path:b+"js/ztree/jquery.ztree.core-3.5.js",requires:["ZTree-css"]});TFL.add("ZTreeCheckbox",{path:b+"js/ztree/jquery.ztree.excheck-3.5.js"});TFL.add("ZTreeExedit",{path:b+"js/ztree/jquery.ztree.exedit-3.5.js",requires:["ZTree"]});TFL.add("ShortcutTool",{path:b+"js/shortcut_tool.js"});TFL.add("WorktableCommonJs",{path:b+"js/worktable/common.js"});TFL.add("ddupload",{path:b+"js/tfl_ddupload.js",requires:["progress"]});TFL.add("PlanViewUpload",{path:b+"js/plan_view_upload.js",requires:["ddupload"]});TFL.add("newPlanViewUpload",{path:b+"js/new_plan_view_upload.js",requires:["ddupload"]});TFL.add("CardViewUpload",{path:b+"js/board/card_view_upload.js",requires:["ddupload"]});TFL.add("ZTree-css",{path:b+"css/ztree/zTreeStyle.css"});TFL.add("WorkspaceChooser",{path:b+"js/workspaceChooser.js",requires:["ZTree","ZTree-css"]});TFL.add("TreeChooser-css",{path:b+"css/treechooser.css"});TFL.add("TreeChooser-css-hebe",{path:b+"css/treechooser_hebe.css"});TFL.add("TreeChooser",{path:b+"js/treechooser.js",requires:["ZTree","TreeChooser-css"]});TFL.add("TreeChooser-hebe",{path:b+"js/treechooser-hebe.js",requires:["ZTree","TreeChooser-css-hebe"]});TFL.add("TreeChooserExcheck",{path:b+"js/ztree/jquery.ztree.excheck-3.5.min.js",requires:["ZTree"]});TFL.add("JqueryValidate",{path:b+"js/jquery.validate.js"});TFL.add("TflValidateTapd",{path:b+"js/tfl-validate-tapd.js",requires:["validate","localData"]});TFL.add("CategoryZtree",{path:b+"js/category_ztree.js",requires:["ZTreeExedit","URLParser"]});TFL.add("JPlayer-css",{path:b+"css/jplayer/jplayer.tapd.css"});TFL.add("JPlayer",{path:b+"js/jplayer/jquery.jplayer.min.js",requires:["JPlayer-css"]});TFL.add("progress",{path:b+"js/progress.js"});TFL.add("UserAccess",{path:b+"js/tfl_user_access.js",requires:["localData"]});TFL.add("StoryCustomStatistic",{path:b+"js/story_custom_statistic.js",requires:["dialog"]});TFL.add("Watermark",{path:b+"js/jquery.watermark.min.js"});TFL.add("MobileSmsVerify-css",{path:b+"css/tcloud/mobile_sms_verify.css"});TFL.add("MobileSmsVerify",{path:b+"js/tcloud/mobile_sms_verify.js",requires:["MobileSmsVerify-css"]});TFL.add("HeaderFloat",{path:b+"js/headerfloat.js"});TFL.add("BoardPublicBoardItemRecord",{path:b+"js/board/public-board-item-record.js"});TFL.add("BoardPublicUrlAction",{path:b+"js/board/public-url-action.js"});TFL.add("BoardPublicDataHelper",{path:b+"js/board/public-data-helper.js"});TFL.add("BoardPublicEditing",{path:b+"js/board/public-editing.js"});TFL.add("BoardPublicCardAction",{path:b+"js/board/public-card-action.js"});TFL.add("BoardPublicScrollbarCtrl",{path:b+"js/board/public-scrollbar-ctrl.js"});TFL.add("BoardPublicBoardAction",{path:b+"js/board/public-board-action.js"});TFL.add("BoardPublicCardDetailAction",{path:b+"js/board/public-card-detail-action.js"});TFL.add("BoardPublicCardDetailMask",{path:b+"js/board/public-card-detail-mask.js"});TFL.add("BoardPublicShortcutAction",{path:b+"js/board/public-shortcut-action.js"});TFL.add("BoardPublic",{path:b+"js/board/board_detail_public.js",requires:["BoardPublicBoardItemRecord","BoardPublicUrlAction","BoardPublicDataHelper","BoardPublicEditing","BoardPublicCardAction","BoardPublicScrollbarCtrl","BoardPublicBoardAction","BoardPublicCardDetailAction","BoardPublicCardDetailMask","BoardPublicShortcutAction"]});TFL.add("BoardJs",{path:b+"js/board/board.js",requires:["BoardPublic"]});TFL.add("WorktableBoardJs",{path:b+"js/worktable/board.js",requires:["BoardPublic"]});TFL.add("TcaseCustomizeSort",{path:b+"js/sparrow/tcase_customize_sort.js"});TFL.add("phoneVerify",{path:b+"js/tcloud/phone_number_verify.js",requires:["MobileSmsVerify-css"]});TFL.add("advancedFilter",{path:b+"js/tcloud/advanced-search-filter.js",requires:["tSelect",{path:b+"css/tcloud/advanced-search-filter.css"},{path:b+"template/advanced-search-filter.art"}]})})(_base,cdn_enabled);function $G(a){return document.getElementById?document.getElementById(a):null}function getNewDate(a){a=a.replace(/\-/g,"/");return new Date(a)}function getAncestorByTagName(b,a){a=a.toLowerCase();do{b=b.parentNode}while(b.nodeType==1&&b.tagName.toLowerCase()!=a);return b.nodeType==1?b:null}function getQueryArray(g,h){var b=h||document.location.search;if(!b||b.indexOf("?")==-1){return{}}var a=b.substr(b.indexOf("?")+1),e=a.split("&"),g=g===undefined?true:g,i={};for(var c in e){var d=e[c].split("=");if(d.length<2){continue}var f=decodeURIComponent(d[1].replace(/\+/g," "));if(f||g){i[decodeURIComponent(d[0])]=f}}return i}function getQueryValue(e,d){var c=d||document.location.search;if(!c||!e){return""}var b=new RegExp("[\\?&]"+encodeURIComponent(e)+"=[^&#]+","g");var a=c.match(b);if(a){return decodeURIComponent(a.pop().substr(1).split("=")[1].replace(/\+/g," "))}else{return""}}function searchHighlight(){if(!document.createElement){return}var e=document.getElementById("searchable");if(!e){return}function a(g){if(g.indexOf("?")==-1){return[]}var m=g.substr(g.indexOf("?")+1);var l=m.split("&");for(var j in l){var k=l[j].split("=");if(k.length<2){continue}if(k[0]=="q"||k[0]=="p"){var h=decodeURIComponent(k[1].replace(/\+/g," "));if(h[0]=="!"){h=h.slice(1)}d=h.split(/(".*?")|('.*?')|(\s+)/);var i=new Array();for(var f in d){d[f]=d[f].replace(/^\s+$/,"");if(d[f]!=""){i.push(d[f].replace(/^['"]/,"").replace(/['"]$/,""))}}return i}}return[]}function c(j,k,f){if(j.nodeType==3){var l=j.nodeValue.toLowerCase().indexOf(k.toLowerCase());if(l>=0&&!/^searchword\d$/.test(j.parentNode.className)){var h=document.createElement("span");h.className="searchword"+(f%5);h.appendChild(document.createTextNode(j.nodeValue.substr(l,k.length)));j.parentNode.insertBefore(h,j.parentNode.insertBefore(document.createTextNode(j.nodeValue.substr(l+k.length)),j.nextSibling));j.nodeValue=j.nodeValue.substr(0,l);return true}}else{if(!j.nodeName.match(/button|select|textarea/i)){for(var g=0;g<j.childNodes.length;g++){if(c(j.childNodes[g],k,f)){g++}}}}return false}var d=a(document.URL);if(!d.length){d=a(document.referrer)}if(d.length){for(var b in d){if(d[b].length){c(e,d[b],b)}}}}function enableControl(f,b){if(typeof b=="undefined"){b=true}var d=document.getElementById(f);if(!d){return}d.disabled=!b;var a=getAncestorByTagName(d,"label");if(a){a.className=b?"enabled":"disabled"}else{var e=document.getElementsByTagName("label");for(var c=0;c<e.length;c++){if(e[c].htmlFor==f){e[c].className=b?"enabled":"disabled";break}}}}function trans(a){document.getElementById("selectedSource").innerHTML=a.innerHTML;document.getElementById("LocaleSourceId").value=a.getAttribute("sourceid");document.getElementById("LocaleTargetId").value=a.getAttribute("targetid");document.getElementById("LocaleTargetTranslation").value=a.getAttribute("translation");document.getElementById("LocaleTargetLocaleId").value=a.getAttribute("locale_id");document.getElementById("localetrans").style.display="";document.getElementById("LocaleTargetTranslation").focus()}function updatecontrollerstatus(){$("input[controller=self]").each(function(){var a=this;var b=true;$(a).parent().find("input").each(function(){b=b&&this.checked});if(!b){$(a).parent().children(".controller").addClass("notall")}else{$(a).parent().children(".controller").removeClass("notall")}})}function checkcontrolleractions(d){var a=d.getAttribute("controller");var c=d.checked;if(a=="self"){a=d.value;$("input[controller="+a+"]").each(function(){$(this).attr("checked",d.checked)});if(d.checked){$(d).parent().children(".controller").removeClass("notall")}else{$(d).parent().children(".controller").addClass("notall")}}else{var e=true;$("input[controller="+a+"]").each(function(){e=e&&(this.checked==c)});var b=$("input[value="+a+"]");if(e){b.attr("checked",c);if(c){b.parent().children(".controller").removeClass("notall")}}else{b.attr("checked",true);b.parent().children(".controller").addClass("notall")}}}function toggleDisplay(a){$(a).swapClass("expandable","collapsable");$(a).parent().find(">ul").toggle()}function collapseAll(a){$(a).find("div.hitarea").replaceClass("collapsable","expandable");$(a).find("div.hitarea").parent().find(">ul").hide()}function expandAll(a){$(a).find("div.hitarea").replaceClass("expandable","collapsable");$(a).find("div.hitarea").parent().find(">ul").show()}function update_left_menu(){if(window.top.left){window.top.left.location.href=window.top.left.location.href}}function fCheckPicutreType(a){var c=document.getElementById(a);var b=c.value.split(".");var e=b[b.length-1];var d=/jpg|gif|png|bmp$/i;if(!d.test(e)){alert("只允许上传jpg、gif、png、bmp图片!");return false}return true}function fCheckFileType(a){var d=document.getElementById(a);var c=d.value.split(".");var b=c[c.length-1];var e=/doc|docx$/i;if(!e.test(b)){alert("只允许上传doc文件!");return false}return true}function initIntegerInput(a){$("input[intinput]").keydown(function(b){var d=b.keyCode;if((d>=48&&d<=57)||(d>=96&&d<=105)||(d>=37&&d<=40)||d==8||d==9||d==46||d==35||d==36||d==109||d==17||(d==189&&!a)||(b.ctrlKey&&(d==67||d==86))){}else{b.preventDefault?b.preventDefault():b.keyCode=0;b.returnValue=false;b.cancelBubble=true}})}function initPositiveInt(a){initIntegerInput(a);$("input[intinput]").on("keyup",function(){var b=$(this).val();$(this).val(b.replace(/[^\d]/g,""));if(b.length>1&&b[0]=="0"){$(this).val(b.substring(1))}});$("input[intinput]").each(function(){this.onpaste=function(){return false}})}function ieFormErrorFix(){if(jQuery.browser.msie){$("select.form_error").wrap('<span class="form_error"></span>')}}function showsubworkspaces(){$("#divSubWorkspaces").attr("left",$(this).attr("scrollLeft"));$("#divSubWorkspaces").slideDown();$(document.body).click(function(){$("#divSubWorkspaces").hide()})}var _arrStaffs;var _arrAdgroups;function deleteObj(b,a){if(confirm(a)){window.location=b+"?ref="+document.URL}}function reflash(){window.location.reload()}function parseQuery(b){var e=b.replace(/^[^\?]+\??/,"");if(!e){e=b.replace(/^[^\&]+\&?/,"")}var f={};if(!e){return f}var a=e.split(/[;&]/);for(var d=0;d<a.length;d++){var h=a[d].split("=");if(!h||h.length!=2){continue}var c=unescape(h[0]);var g=unescape(h[1]);g=g.replace(/\+/g," ");f[c]=g}return f}String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};function prevent_reduplicate_submit(c){var b=$("#deal_dump_submit_button").length;var a=document.createElement("input");a.id="deal_dump_submit_button";a.name=$(c).attr("name");a.value=$(c).attr("value");a.type="button";a.disabled="true";$(c).before(a);class_name=$(c).attr("class");if(class_name!=""||class_name!="undefined"){$("#deal_dump_submit_button").addClass(class_name)}$(c).hide();if(b>0){return false}else{return true}}function onGoTo(a,b){var b=arguments[1]?arguments[1]:"_self";if(typeof tapd_dsc==="object"){tapd_dsc.add_dsc_to_form("onhref")}$("#onhref").attr("action",a).attr("target",b).submit()}function loadJsFile(e,c,g){var b=g||document;if(c){for(var a=GelTags("script",b),d=a.length-1;d>=0;d--){if(a[d].src.indexOf(e)!=-1){return}}}var h=b.createElement("script"),f=GelTags("head",b)[0]||b.documentElement;h.type="text/javascript";h.src=e;h.setAttribute("async",true);f.appendChild(h);return h}function loadCssFile(h,f,a){var j=a||document;if(f){for(var c=GelTags("link",j),e=c.length-1;e>=0;e--){if(c[e].href.indexOf(h)!=-1){return}}}var b=j.createElement("link"),g=GelTags("link",j);b.type="text/css";b.rel="stylesheet";b.href=h;if(g.length>0){var d=g[g.length-1];d.parentNode.insertBefore(b,d.nextSibling)}else{(GelTags("head",j)[0]||j.documentElement).appendChild(b)}return b}function GelTags(b,a){return(a||document).getElementsByTagName(b)}function is_scroll(){return document.body.scrollWidth-$(window).width()>0}var Class=function(b){var a=function(){return(arguments[0]!==null&&this.initialize&&typeof(this.initialize)=="function")?this.initialize.apply(this,arguments):this};$.extend(a,this);a.prototype=b;a.constructor=Class;a.prototype.base=function(){return this.prototype.initialize.apply(this,arguments)};return a};Class.prototype.extend=function(a){this.prototype=$.extend({},a.prototype,this.prototype);this.prototype.prototype=a.prototype;this.prototype.baseclass=a.prototype};var TapdEvent={Category_tree_reload_complete:"category_tree_reload_complete",Category_clicked:"category_clicked",Stories_tree_table_updated:"stories_tree_table_updated",Export_tapdbox_url_updated:"export_tapdbox_url_updated",Iteration_content_loaded:"iteration_content_loaded",Iteration_loaded_by_url:"iteration_loaded_by_url"};function iframe_download(a){if(0<$("#iframe_for_down").length){$("#iframe_for_down").remove()}var b=document.createElement("iframe");b.src=a+"?r="+Math.random();b.id="iframe_for_down";b.className="iframe_for_downing";b.style.display="none";document.body.appendChild(b);b.onload=function(){hide_preload()}}function isNumber(b){var a=b;return(a.search(/^[+-]?[0-9.]*$/)>=0)}function isEmptyHtmlEditor(c){if($("#editor-"+c).length){return TFL.editor.getInstance(c).isEmpty()}var b,a=false;if(typeof(GetContent)!="undefined"){b=GetContent()}else{b=$.trim(qmEditor.getEditor(c).getContent())}if(b==""||"<p>&nbsp;</p>"==b.toLowerCase()||"<div>&nbsp;</div>"==b.toLowerCase().replace(/\s$/,"")||"<br>"==b.toLowerCase()||"<div><br></div>"==b.toLowerCase()){a=true}return a}function get_richeditor_content(b){var a="";if(TFL.editor&&TFL.editor.getInstance(b)){var a=TFL.editor.getInstance(b).html()}else{if(typeof(GetContent)=="undefined"){var a=qmEditor.getEditor(b+"Editor").getContent()}else{var a=GetContent()}}return a}function preg_quote(a){return(a+"").replace(/([\.\\\\/+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:\-])/g,"\\$1")}function htmlspecialchars_decode(b){var a={"&amp;":"&","&#37;":"%","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#40;":"(","&#41;":")","&#43;":"+","&#45;":"-","&#92;":"\\"};return b.replace(/&amp;|&#37;|&lt;|&gt;|&quot;|&#39;|&#40;|&#41;|&#43;|&#45;|&#92;/ig,function(c){return a[c]})}function htmlspecialchars_encode(b){var a={"&":"&amp;","%":"&#37;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","(":"&#40;",")":"&#41;","+":"&#43;","-":"&#45;","\\":"&#92;"};return b.replace(/&|%|<|>|"|'|\(|\)|\+|-|\\/ig,function(c){return a[c]})}function valiDateTime(e){if(e==""){return true}var a=/^(\d{4})-(\d{1,2})-(\d{1,2})$/;var b=e.match(a);if(b==null){return false}b[2]=b[2]-1;var c=new Date(b[1],b[2],b[3]);if(c.getFullYear()!=b[1]){return false}if(c.getMonth()!=b[2]){return false}if(c.getDate()!=b[3]){return false}return true}function show_load_indicator(){$("#load-indicator").show()}function hide_load_indicator(){$("#load-indicator").hide()}function hide_drop_menu(){TFL.dropdown.clearMenus()}function reloadPageAfterFlash(d,b){TFL.tips.showFlash(d);var a=b?b:3000;var c=setTimeout(function(){window.location.reload()},a);$(document).delegate("#flash_message a","click",function(){clearTimeout(c)})}function locationPageAfterFlash(e,c,b){TFL.tips.showFlash(e);var a=c?c:3000;var d=setTimeout(function(){window.location.href=b},a);$(document).delegate("#flash_message a","click",function(){clearTimeout(d)})}var confirm_dialog=function(d,c,b,a){TFL.confirm.show(d,c,b,a)};function init_date_input(){}function do_date_Picker(a){TFL.use("uiDatepicker",function(){TFL.datepicker._config(a).datepicker("show").removeAttr("onfocus").removeClass("tapd-new-date")})}function tapd_tb_show(e,b,a,d,c){TFL.dialog.show({title:e,url:b,useIframe:a,dataBtn:d,fullscreen:c})}function tapd_tb_remove(c,a,b,d){TFL.dialog.close(c,a,b,d)}function my_tapd_tb_show(b){var g=$(b),f=g.attr("title")||g.attr("name")||"",c=g.attr("href")||g.attr("url"),a=g.attr("useiframe")=="false"?false:true,e=g.attr("btns")||"",d=TFL.tagBoolean("fullscreen",g,true);TFL.dialog.show({title:f,url:c,useIframe:a,dataBtn:e,fullscreen:d});g.blur();return false}function tapd_tb_init(){}function init_tapdbox(){}function show_flash_message(a){TFL.tips.showFlash(a)}function show_preload(a){TFL.tips.showPreload(a)}function hide_preload(){TFL.tips.hidePreload()}var customBtn={do_disable:function(){},do_able:function(){}};var app_scroller={init:function(e){var f={panelWidth:0};var g=jQuery.extend(f,e);var a=g.scroller;var d=g.panel.length;a.width(d*18);var c=0,b="";for(;c<d;c++){b+="<a class='app_dot' href='javascript:;' index='"+c+"'></a>"}a.find("p").html(b);a.find(".app_dot").bind("click",function(){app_scroller.doscroll($(this).attr("index"),g)})},doscroll:function(c,d){var e=d.tagetObj;e.stop();var b=d.panelWidth;var a=(-b*c);e.animate({left:a},500);d.scroller.find(".app_ontag").animate({left:c*18+8},500)}};TFL.widget("funToggle",{init:function(){$("body").delegate(".fun-toggle","click",TFL.funToggle._bind)},_bind:function(){var a=$(this);if(a.hasClass("disabled")){return}TFL.funToggle.slide(a)},slide:function(a){var b=$(a);if(b.hasClass("on")){b.animate({"background-position":"100% 0%"},500).addClass("off").removeClass("on")}else{b.animate({"background-position":"0% 0%"},500).addClass("on").removeClass("off")}}},true);TFL.widget("funToggleSmall",{init:function(){$("body").delegate(".fun-toggle-small","click",TFL.funToggleSmall._bind)},_bind:function(){var a=$(this);if(a.hasClass("disabled")){return}TFL.funToggleSmall.slide(a)},slide:function(a){var b=$(a);if(b.hasClass("on")){b.animate({"background-position":"100% 0%"},500).addClass("off").removeClass("on")}else{b.animate({"background-position":"0% 0%"},500).addClass("on").removeClass("off")}}},true);TFL.widget("tabOverflow",{allLi:null,totalWidth:0,widthArr:[],init:function(a,g,e,b){var c=$(a),f=$(g),d=arguments[3]==undefined?true:arguments[3];this.allLi=c.find("> li");this.allLi.each(function(){var h=$(this).outerWidth(true);TFL.tabOverflow.totalWidth+=h;TFL.tabOverflow.widthArr.push(h)});this._calculation(c,f,e);if(d){$(window).resize(function(){TFL.tabOverflow._calculation(c,f,e)})}},_calculation:function(d,a,k){var e=a.width(),j=100,h=0,b=0,f=20,c=$("#tab-overflow");$(this.widthArr).each(function(m,n){h+=n;if((h+j>e)&&!b){b=m;return false}});if(c.length){if(d.find("> li").index(c)==b){return}else{var g=c.find("li");g.insertAfter(c)}}if((this.totalWidth+f)>e){var l;if(!c.length){l=$("<li id='tab-overflow' class='dropdown' data-dropdown='click'><a class='dropdown-toggle'>"+k+" <i class='arr'></i></a><div class='dropdown-menu'><ul></ul><div class='dropdown-shadow'></div></div></li>")}else{l=c}l.insertAfter(this.allLi.eq(b-1));var i=l.nextAll("li");l.find("ul").append(i)}else{c.remove()}}});TFL.widget("Util",{array_keys:function(c){var b=new Array();for(var a in c){b.push(a)}return b},merge:function(a,d){var b=a;for(var c in d){b[c]=d[c]}return b},escapeHtml:function(a){var c=document.createElement("div");var b=document.createTextNode(a);c.appendChild(b);return c.innerHTML}});TFL.widget("listTable",{opts:{},$tableWrap:null,$batchMenu:$(),$batchMenuBackup:null,listAction:function(a){var c=this;var b={wrap:"div.list-content-wrap",ddm:".dropdown-operation",checkbox:".flag_area input[type=checkbox]",checkAll:"#check_all",batchMenuTempl:"#menu_template .dropdown-operation",batchEdit:true};c.opts=$.extend({},b,a);c.$tableWrap=$(c.opts.wrap);if(c.$tableWrap.attr("data-initListAction")=="true"){return false}c.$tableWrap.delegate(c.opts.ddm,"click",function(d){c._clickMenu(this,d)});c.$tableWrap.delegate("tr","mousemove",function(d){$(this).find(c.opts.ddm).removeClass("fixie").addClass("fixie")});$(document).click(function(d){c._clickMenu(this,d)});if(c.opts.batchEdit){c._initBatch()}c.$tableWrap.attr("data-initListAction","true")},_initBatch:function(){var a=this;a.$batchMenu=$(a.opts.batchMenuTempl).find("div.dropdown-menu");a.$batchMenuBackup=a.$batchMenu.clone();this._insertMenuTitle();a.$tableWrap.delegate("a.batch-dropdown-toggle","mousedown",function(){a.toggleBatchMenu(this)});a.$tableWrap.delegate(a.opts.checkbox,"click",function(){a.checkItem(this)});a.$tableWrap.delegate(a.opts.checkAll,"click",function(){a._checkAll(this)});$(document).bind("dropdownopen",function(b){if($(b.target).parent(".batch-dropdown-operation").length){a._updateCount(b.target)}});a._initChecked()},_initChecked:function(){var a=this;$(a.opts.checkbox).filter(":checked").each(function(){a.checkItem(this)})},_clickMenu:function(c,a){var b=this;if(!$(a.target).closest(b.opts.ddm).length){b.$tableWrap.find("tr.click-tr").removeClass("click-tr")}else{$(c).closest("tr").addClass("click-tr").siblings().removeClass("click-tr")}},checkItem:function(b){var c=this;var a=$(b).closest("tr").addClass("checked-tr").find("td.list-action>div");if($(b).prop("checked")){c._initBatchMenu(a)}else{$(b).closest("tr").removeClass("checked-tr")}a.find("div.dropdown-operation").removeClass("fixie").addClass("fixie");a=null},_checkAll:function(a){var b=this;if($(a).prop("checked")){$(b.opts.checkbox+"[class!=no-permission]").prop("checked",true).each(function(){b.checkItem(this)})}else{$(b.opts.checkbox).prop("checked",false).each(function(){b.checkItem(this)})}},_insertMenuTitle:function(){var a='<li class="title counter"><span>批量处理(选中1项)</span><i class="arrow"><b></b></i></li>';if(!this.$batchMenu.find("li.title").length){this.$batchMenu.find("ul").prepend(a)}},_updateCount:function(c){var b=t("num_selected_for_batch_action");var a=$(this.opts.checkbox).filter(":checked").length;$(c).find("li.title span").html(b.replace("%s",a))},_initBatchMenu:function(b){var c=this;if(b.find(".batch-dropdown-operation").length||!$(c.opts.batchMenuTempl).length){return false}if(isLego()){var a='<div class="dropdown-operation batch-dropdown-operation">	<div class="dropdown" data-dropdown="click">	<a class= "dropdown-toggle batch-dropdown-toggle" href="javascript:;"><i class="ico-drop-select"></i></a>	</div></div>'}else{var a='<div class="dropdown-operation batch-dropdown-operation">	<div class="dropdown" data-dropdown="click">	<a class= "ico-gear-down dropdown-toggle batch-dropdown-toggle" href="javascript:;"></a>	</div></div>'}b.append(a)},toggleBatchMenu:function(a){if(!this.$batchMenu.length){this.$batchMenu=this.$batchMenuBackup.clone()}$(a).parent().append(this.$batchMenu)}});TFL.widget("autoSave",{auto_save:function(c){var f={auto_save_url:"",entity_type:"Story",description_id:"StoryDescription",form_id:"FormStory"};c=$.extend(f,c);if(formChangeTips_ref.isChange){var a=$('input[name="data[is_editor_or_markdown]"]').val();if(a==2&&TFL.markdown&&TFL.markdown.getInstance(c.description_id)){var b=TFL.markdown.getInstance(c.description_id);b.beforeFormSubmit();b.transWikiToHtml()}else{var d=get_richeditor_content(c.description_id);$("#"+c.description_id).val(d)}var e=$("#"+c.form_id);e.ajaxSubmit({dataType:"text",type:"post",url:c.auto_save_url,success:function(k,i){var g=$("<div>"+k+"</div>").find("#result_link");if("failed"!=g.text()){$(".draft-link").show();var j=g.attr("draft_id");if(0==$("#draft_id").length){var l=$('<input id="draft_id" style="display:none" value="" name="data[draft_id]" />');e.append(l);var h=parseInt($("#draft_count").text())+1;$("#draft_count").text(h)}$("#draft_id").val(j);formChangeTips_ref.isChange=false;show_flash_message(k)}}})}}});TFL.widget("scrollSpy",{run:function(c,a,b){if(!c.size()){return}setTimeout(function(){function d(){var e=$(document).height();var g=$(document).scrollTop();var h=$(window).height();var f=b;if(c.hasClass(a)){f=30}if(e-h-g>f){c.addClass(a)}else{c.removeClass(a)}}d();$(window).scroll(d);$(window).resize(d)},150)}});$(function(){TFL.scrollSpy.run($(".form-action-spy"),"form-action",106)});function setPageConfigPosition(){if(!$("#filter_button").length){return false}var a=$("#page-content"),b="filter-section-open",c="filter-section-close";if(!!$("div.filter-panel:visible").length||!!$("div.query_results_box:visible").length){a.addClass(b).removeClass(c)}else{a.addClass(c).removeClass(b)}}function simplePager(){$(".page-select li a").click(function(){var a=$(this).text();$(this).closest("li").addClass("current").siblings().removeClass("current");$(this).closest(".page-select").find(".current-page").text(a)});$("body").bind("dropdownopen",function(c){var d=$(c.target);if(d.hasClass("page-select")){var b=d.find("ul"),a=d.find("li.current");if(a.length){if(a.prev().length){a=a.prev()}b.scrollTop(0).scrollTop(a.position().top)}}})}function dropAnchor(a){var b="modified_item_tr";$("body").delegate(a,"mousedown",function(c){$(this).closest("table").find("tr."+b).removeClass(b);var d=$(c.target).closest("tr").addClass(b).attr("id")})}function fixZindex(b){var a=$(b);if(!$("html.ie7").length||!a.length){return false}var c=a.css("z-index");a.bind("dropdownclose",function(){$(this).css({"z-index":c})}).bind("dropdownopen",function(){$(this).css({"z-index":999})})}TFL.timer=TFL.timer||[];function scrollingTag(a,b){$(window).scroll(function(){if($(window).scrollTop()>a){$("body").addClass(b)}else{$("body").removeClass(b)}})}function responseMenu(a,b){function d(e,f){if($("body").hasClass("left-tree-close")){offset=0}else{offset=200}if($(window).width()-offset<e){$("body").addClass(f)}else{$("body").removeClass(f)}if($(window).width()<1380){$("body").addClass("minwindow")}else{$("body").removeClass("minwindow")}$("body").trigger("menu_resize")}d(a,b);if(typeof TFL.timer.mediaTag==="undefined"){TFL.timer.mediaTag=[]}var c=TFL.timer.mediaTag.length;TFL.timer.mediaTag[c]=null;$(window).bind("resize",function(){clearTimeout(TFL.timer.mediaTag[c]);TFL.timer.mediaTag[c]=setTimeout(function(){d(a,b)},50)});$(document).bind("leftTreeToOpen",function(){d(a,b)})}function isLego(){if(typeof tui_skin!=="undefined"&&tui_skin==="lego"){return true}else{return false}}function log(){if(typeof isDev==="undefined"||isDev!=="1"){return false}if(arguments[0]==="alert"){alert(arguments[1]);return}if(window.console&&console.log){if(!console.log.apply){var a=Array.prototype.splice.call(arguments,0,arguments.length);console.log(a.toString())}else{console.log.apply(console,arguments)}}else{alert(arguments[0])}return}function tapdDevTool(){$(window).keydown(function(a){if(a.keyCode==119){}})}(function(a){a.fn.placeholder=function(){if("placeholder" in document.createElement("input")){return a(this)}else{return a(this).each(function(){var c=a(this);var b=a.trim(c.attr("placeholder"))||"";if(b&&c.val()===""){c.val(b);c.addClass("placeholder")}c.focus(function(){var d=a.trim(c.val());if(d===""||d===b){c.removeClass("placeholder").val("")}}).blur(function(){var d=a.trim(c.val());if(d===""||d===b){c.addClass("placeholder").val(b)}})})}};a.fn.prettyPlaceHolder=function(){var b=a(this).prev("label");var d=a(this);var c=function(){if(d.val()==""){b.show()}else{b.hide()}};c();d.bind("input propertychange",c)}})(jQuery);function simulatePlaceholder(d,c,b){if($.browser.msie){c=c?c:"输入标题";b=b?b:"";var a=$('<label data-type="'+b+'" for="'+d+'" class="placeholder hide">'+c+"</label>");$("#"+d).before(a).prettyPlaceHolder()}}var serverTip={closeTip:function(c,b){if(!c){console.log("error: no id!")}var a=_base+_workspace_id+"/usernews/disable_new/"+c;$.get(a,function(d){b&&b(d)})},getTip:function(c,b){if(!c){console.log("error: no id!")}var a=_base+_workspace_id+"/usernews/get_user_new_tip/"+c;$.get(a,function(d){b&&b(d)},"json")}};function check_flash_plugin(){var b=navigator.plugins;var a=false;var c=0;var g=false;try{var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");g=true;if(f){a=true;VSwf=f.GetVariable("$version");c=parseInt(VSwf.split(" ")[1].split(",")[0])}}catch(h){if(b.length>0&&b["Shockwave Flash"]){a=true;var f=navigator.plugins["Shockwave Flash"];var j=f.description.split(" ");for(var d=0;d<j.length;++d){if(isNaN(parseInt(j[d]))){continue}c=parseInt(j[d])}}}return{f:a,v:c,ie:g}}function global_copy_data_function(b,a){$use_flash=true;a=a?a:"已拷贝到剪切板";try{if(document.queryCommandSupported("copy")){$use_flash=false}}catch(c){}if($use_flash){if(check_flash_plugin().f){TFL.use(_base+"js/ZeroClipboard2.0.0.js",function(){var d=new ZeroClipboard(b);d.on("ready",function(e){d.on("copy",function(f){var g=$($(f.target).attr("data-clipboard-target")).val();f.clipboardData.setData("text/plain",g)});d.on("aftercopy",function(f){TFL.tips.showFlash(a)})});d.on("error",function(e){ZeroClipboard.destroy()})})}else{b.click(function(){TFL.tips.showFlash("没有安装flash播放器")})}}else{b.mouseover(function(){if(b.attr("data-clipboard-init")!=="1"){TFL.use(_base+"js/clipboard.js",function(){var d=new Clipboard(b[0]);d.on("success",function(f){f.clearSelection();TFL.tips.showFlash(a)})});b.attr("data-clipboard-init","1")}})}}function int_validation_event(f,b){var h=(f.keyCode)||(f.which)||(f.charCode);if((h>=48&&h<=57)||(h>=96&&h<=105)||(h>=37&&h<=40)||h==8||h==9||h==46||h==35||h==36||h==189||h==109||h==17||(f.ctrlKey&&(h==67||h==86))){}else{var g=$(b).attr("id");var a=g+"TipTemp";var d=$("#"+a);if(0==d.size()){var d=$("<div></div>");d.attr("id",g+"TipTemp");d.insertAfter($(b))}d.show();d.text("只能输入整数！");d.addClass("red");setTimeout(function(){d.fadeOut()},1000);f.preventDefault?f.preventDefault():f.keyCode=0;f.returnValue=false;f.cancelBubble=true}}function float_validation_event(f,b){var h=(f.keyCode)||(f.which)||(f.charCode);console.log(h);if((h>=48&&h<=57)||(h>=96&&h<=105)||(h>=37&&h<=40)||h==8||h==9||h==46||h==35||h==36||h==189||h==109||h==17||(f.ctrlKey&&(h==67||h==86))){}else{var g=$(b).attr("id");if(h==110||h==190){if(!/\./.test($("#"+g).val())){return""}}var a=g+"TipTemp";var d=$("#"+a);if(0==d.size()){var d=$("<div></div>");d.attr("id",g+"TipTemp");d.insertAfter($(b))}d.show();d.text("只能输入整数或小数！");d.addClass("red");setTimeout(function(){d.fadeOut()},1000);f.preventDefault?f.preventDefault():f.keyCode=0;f.returnValue=false;f.cancelBubble=true}}function init_Integer_Input(){$("input[intinput]").not("input[inited]").keydown(function(a){int_validation_event(a,$(this))}).keyup(function(a){$(this).val($(this).val().replace(/[\uFF00-\uFFFF]/g,""))}).bind("paste",function(){return false});$("input[intinput]").not("input[inited]").attr("inited","true").attr("style","ime-mode:disabled")}function init_Floa_Input(){$("input[floatinput]").not("input[inited]").keydown(function(a){float_validation_event(a,$(this))}).keyup(function(a){$(this).val($(this).val().replace(/[\uFF00-\uFFFF]/g,""))}).bind("paste",function(){return false});$("input[floatinput]").not("input[inited]").attr("inited","true").attr("style","ime-mode:disabled")}function replace_slash(a,b){if(typeof(b)=="undefined"){b="@@@^^^@@@"}a=a.replace(/\//g,b);return a}function replace_plus(a,b){if(typeof(b)=="undefined"){b="@@@***@@@"}a=a.replace(/\+/g,b);return a}function noH5Validate(){$("form").each(function(){this.noValidate=true})}function disabledEnterSubmit(a){$(a).bind("keydown",function(b){if($(b.target).is("input[type=text]")&&b.keyCode===13){return false}})}function inviteCheckbox(){var a=function(b){if(b.checked){$(b).parent().addClass("selected")}else{$(b).parent().removeClass("selected")}};$("#invite_area input[type='checkbox'], #invite_ways input[type='checkbox']").each(function(){a(this)});$("#invite_area input[type='checkbox'], #invite_ways input[type='checkbox']").click(function(){a(this)})}(function(a){a.fn.intinput_validation=function(){a(this).css("ime-mode","disabled");a(this).keydown(function(b){int_validation_event(b,a(this))}).keyup(function(b){a(this).val(a(this).val().replace(/[\uFF00-\uFFFF]/g,""))}).bind("paste",function(){return false})};a.fn.intinput_validation_multi=function(){a(this).find("input[intinput]").css("ime-mode","disabled");a(this).delegate("input[intinput]","keydown",function(b){int_validation_event(b,a(this))}).delegate("input[intinput]","keyup",function(b){a(this).val(a(this).val().replace(/[\uFF00-\uFFFF]/g,""))}).delegate("input[intinput]","paste",function(b){return false})}})(jQuery);if(typeof fail_function==="undefined"){var fail_function=function(b,a){TFL.tips.showFlash(b,true,3000)}}function user_avatar(a,e,c){var b="";e=e||_workspace_id||0;if(!Date.prototype.toISOString){(function(){function f(h){var g=String(h);if(g.length===1){g="0"+g}return g}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1000).toFixed(3)).slice(2,5)+"Z"}}())}c=c||(new Date()).toISOString().substr(0,10);if(typeof a==="string"){b=a}else{if(typeof user_nick==="string"){b=user_nick}else{b=""}}if(isCloud){var d=(typeof a==="number")?a:user_id;return _base+e+"/users/avatar/"+d+"?t="+c}else{return _base+e+"/users/avatar/"+b}}function autofocus(){if(jQuery.browser.msie){setTimeout(function(){$("input[autofocus]").focus()},1000)}}function revocation_delete(g){var f;if($(g).attr("bug_ids")){f=$(g).attr("bug_ids");type="bug"}else{if($(g).attr("story_ids")){f=$(g).attr("story_ids");type="story"}else{if($(g).attr("task_ids")){f=$(g).attr("task_ids");type="task"}else{return false}}}var j;switch(type){case"bug":j="/bugtrace/bugs";break;case"story":j="/prong/stories";break;case"task":j="/prong/tasks";break}var b=!!$(g).attr("single_recover");if(!!f){var h=_base+_workspace_pretty_name+j+"/recover_delete";if(b){h+="/1"}var c=f.split("-");var a={};for(var d=0;d<c.length;d++){a[d]=c[d]}}TFL.tips.showPreload();$.post(h,a,function(e){location.reload()})}function priority_call_back(b){var a=$(b).attr("data-editable-value");if("高"==a||"紧急"==a||"High"==a||"high"==a){$(b).addClass("high_priority")}else{$(b).removeClass("high_priority")}}function severity_call_back(b){var a=$(b).attr("data-editable-value");if("严重"==a||"致命"==a){$(b).addClass("high_priority")}else{$(b).removeClass("high_priority")}}if(document.addEventListener){document.addEventListener("error",function(b){var a=$(b.target);if(a.hasClass("common-avatar-img")){if(typeof isCloud!="undefined"&&true==isCloud){a.next(".avatar-text-default").show();a.remove()}else{if(typeof isExternal!="undefined"&&true==isExternal){b.target.src=_base+"img/avatar.jpg"}else{b.target.src="http://dayu.oa.com/avatar/default.png"}}}},true);document.addEventListener("load",function(d){var a=$(d.target);if(a.hasClass("common-desc-img")&&!a.hasClass("gallery")){var b=a.width();var c=$("#description_div").width();a.css("max-width",c);a.click(function(){var e=a.attr("original_src");window.open(e)})}},true)}$(document).ready(function(){$("body").bind("show_flash_message",function(d){TFL.tips.showFlash(d.msg)});autofocus();setPageConfigPosition();$(document).bind("tuiFilterOpen",setPageConfigPosition).bind("tuiFilterClose",setPageConfigPosition);simplePager();dropAnchor("#story-worktable-list tr,#bug-worktable-list tr,#task-worktable-list tr, #story_list_content tr,#task_table tr, #bug_list_content tr, #tcase_list_table tr, #plan_list_table tr, #form_list tr, #stories_tasks_content tr, #bug_content tr, #bugquery_table tr, [id^=iteration_table_] tr, #releases-list tr,#tobject-instance-list tr,#launch-worktable-list tr");fixZindex("#stories_tree_table .table-action-top div.abs_right");scrollingTag(26,"scrolltop");responseMenu(1280,"minimenu");noH5Validate();disabledEnterSubmit(".editform");inviteCheckbox();if(isLego()){var b=function(){$("body").delegate(".table td a, .g_table td a, #base_information a","mouseenter",function(){if($(this).closest("#wiki_content").length){return true}if($(this).hasClass("no_blank")){return true}if($(this).parents(".dropdown-menu").length>0){var e=$.trim($(this).text());if(e!="编辑"&&e!="Edit"&&e!="edit"&&e!="创建子需求"&&e!="Add Child"&&e!="创建需求"&&e!="Add Story"){return true}}if($(this).is('[class*="tapd-btn"]')){return true}var d=$.trim($(this).attr("href"));if(!d||d=="#"||d=="javascript:;"){return true}if(typeof(_is_wework_desktop)!=="undefined"&&_is_wework_desktop){return true}if($(this).attr("target")!="_blank"){$(this).attr("target","_blank")}})};b();$(document).ajaxComplete(function(){b()})}if(typeof isDev!=="undefined"||isDev==="1"){tapdDevTool()}TFL.use("HeaderFloat",function(){TFL.HeaderFloat.init({ajax_table:false})});var a=document.title;try{if(typeof isChangeTitle=="undefined"){document.attachEvent("onpropertychange",function(){if(document.title!=a){document.title=a}})}}catch(c){}});function modify_title(a){rememberTitle=a;document.title=a}function identityCodeValid(j){var e={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};var m=j.substr(6,4)+"/"+Number(j.substr(10,2))+"/"+Number(j.substr(12,2));var h=new Date(m);var n=h.getFullYear()+"/"+Number(h.getMonth()+1)+"/"+Number(h.getDate());var b=new Date().getTime();var c=h.getTime();var k=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2];var l=["1","0","X","9","8","7","6","5","4","3","2"];var g=0,f,a;if(!/^\d{17}(\d|x)$/i.test(j)){return false}if(e[j.substr(0,2)]===undefined){return false}if(c>=b||m!==n){return false}for(f=0;f<17;f++){g+=j.substr(f,1)*k[f]}a=l[g%11];if(a!==j.substr(17,1)){return false}return true}function array_unique(d){var c={},b=[];for(var a=0;a<d.length;a++){if(!c[d[a]]){c[d[a]]=true;b.push(d[a])}}return b}String.prototype.sub=function(b){var d=/[^\x00-\xff]/g;if(this.replace(d,"mm").length<=b){return this.toString()}var a=Math.floor(b/2);for(var c=a;c<this.length;c++){if(this.substr(0,c).replace(d,"mm").length>=b){return this.substr(0,c)}}return this.toString()};function if_mindmap_illegal_char(c){var d=["~","!","@","#","$","%","^","&","*","=","?","/","|",'"',"\\"],a=0,b=false;for(;a<d.length;a++){if(c.indexOf(d[a])!=-1){b=true;break}}return b}function isEmptyObject(b){for(var a in b){return false}return true}function escEvent(){$(document).keydown(function(b){var a=$(".treechooser-filter").is(":focus");var c=$(".treechooser-filter").val();if(27==b.keyCode){if(a){if(c==""){parent.TFL.dialog.close()}else{$(".treechooser-filter").val("")}}else{parent.TFL.dialog.close()}}})}function ajax_save_workspace_switch(b,d,c,e){var a=b+d;$.post(a,{ajax_sw_name:d,ajax_sw_value:c},function(f){if(f.status==0){TFL.tips.showFlash(e[d].failed);return}else{if(c){TFL.tips.showFlash(e[d].enable_success)}else{TFL.tips.showFlash(e[d].cancle_success)}}},"json")}function strReplaceAll(c,b,a){return c.replace(new RegExp(b,"gm"),a)}function isContainsLetterNumberOrdot(a){var b=/[A-Za-z0-9_\.]/;if(b.test(a)){return true}else{return false}}function switchNewIteration(a){$.cookie("iteration_type_"+a,"card_view",{expires:30,path:"/"});location.href=_base+_workspace_pretty_name+"/prong/iterations/card_view"}function switchOldIteration(a){$.cookie("iteration_type_"+a,"index",{expires:30,path:"/"});location.href=_base+_workspace_pretty_name+"/prong/iterations/index"}jQuery.fn.putCursorAtEnd=function(){return this.each(function(){var b=$(this),c=this;if(!b.is(":focus")){b.focus()}if(c.setSelectionRange){var a=b.val().length*2;setTimeout(function(){c.setSelectionRange(a,a)},1)}else{b.val(b.val())}this.scrollTop=999999})};function replaceImgTag(c){var b=$("#description_div").width();var a=fileBasePath+"compress/compress_img/"+b;return _replaceImgTagWithCompressPath(c,a,b)}function _replaceImgTagWithCompressPath(f,a,d){var e=/<img[^>]*?src=\"(?:^data)?([^>\"]*?\.(jpg|jpeg|gif))\"[^>]*?>/ig;var c="<img \n	onload=\"\n\tvar width = $(this).width();\n\t$(this).css('max-width', '"+d+'px\');\n\t$(this).click(function(){\n\t\tvar original_src = $(this).attr(\'original_src\');\n\t\twindow.open(original_src);\n\t});"\n title="点击看原图" class="compress" src="'+a+'?src=COMPRESS_SRC_PATH" original_src="ORIGINAL_SRC_PATH" style="max-width:'+d+'px;COMPRESS_STYLE_STR"/>';var b=f.replace(e,function(i,g){var k=g;if(k.toLowerCase().indexOf("tfl/img/emoticons/")!=-1){return i}var o=/^http(s?):\/\//;var p=new RegExp(_base,"g");var n,l;var m,j,h;if(!o.test(k)){n=fileBasePath+k}else{n=k.replace(p,fileBasePath)}k=htmlspecialchars_encode(k);l=c.replace(/COMPRESS_SRC_PATH/g,k);m=i.match(/style=['\"]([^'\"]+)['\"]/i)?i.match(/style=['\"]([^'\"]+)['\"]/i):[];if(m.length!=0){l.replace(/\s+width=['\"]([0-9]+)['\"]/i,"");l.replace(/\s+height=['\"]([0-9]+)['\"]/i,"");l=l.replace(/COMPRESS_STYLE_STR/g,m[1])}else{j=i.match(/\s+width=['\"]([0-9]+)['\"]/i)?i.match(/\s+width=['\"]([0-9]+)['\"]/i)[1]:[];h=i.match(/\s+height=['\"]([0-9]+)['\"]/i)?i.match(/\s+height=['\"]([0-9]+)['\"]/i)[1]:[];m="width:"+j+"px;height:"+h+"px;";l=l.replace(/COMPRESS_STYLE_STR/g,m)}return l});if(b==""||b==undefined||b==null){return f}f=b;e=/<img[^>]*?src=\"(?:^data)?([^\">]*?\.(png|bmp))\"[^>]*?>/ig;b=f.replace(e,function(m,k){var l=k;var i=/^http(s?):\/\//;var h=new RegExp(_base,"g");var g,j;if(!i.test(l)){g=fileBasePath+l}else{g=l.replace(h,fileBasePath)}l=htmlspecialchars_encode(l);j=c.replace(/COMPRESS_SRC_PATH/g,l);j=j.replace(/ORIGINAL_SRC_PATH/g,g);style_str=m.match(/style=['\"]([^'\"]+)['\"]/i)?m.match(/style=['\"]([^'\"]+)['\"]/i):[];if(style_str.length!=0){j.replace(/\s+width=['\"]([0-9]+)['\"]/i,"");j.replace(/\s+height=['\"]([0-9]+)['\"]/i,"");j=j.replace(/COMPRESS_STYLE_STR/g,style_str[1])}else{width_str=m.match(/\s+width=['\"]([0-9]+)['\"]/i)?m.match(/\s+width=['\"]([0-9]+)['\"]/i)[1]:[];height_str=m.match(/\s+height=['\"]([0-9]+)['\"]/i)?m.match(/\s+height=['\"]([0-9]+)['\"]/i)[1]:[];style_str="width:"+width_str+"px;height:"+height_str+"px;";j=j.replace(/COMPRESS_STYLE_STR/g,style_str)}return j});if(b==""||b==undefined||b==null){return f}return b}jQuery.cookie=function(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+(m.path):"";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}};